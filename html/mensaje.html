<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/mensaje.css">
</head>
<body>
    <div class="container">
        <div class="header">
          <h2>Abel</h2>
        </div>
        <div class="messages">
          <!-- aquí se mostrarían los mensajes -->
        </div>
        <form class="message-form">
          <input id="message-input" type="text" placeholder="Escribe tu mensaje aquí...">
          <button class="send-button"><img src="../img/mensaje.png" alt="" width="20" height="20"></button>
          <button class="delete-button">⌫</button>
        </form>
      </div>

<script type="text/javascript">
const messageForm = document.querySelector('.message-form');
const messageInput = document.querySelector('#message-input');
const messagesDiv = document.querySelector('.messages');

messageForm.addEventListener('submit', (event) => {
  event.preventDefault();

  const messageText = messageInput.value;
  const newMessage = document.createElement('p');
  newMessage.textContent = messageText;
  messagesDiv.appendChild(newMessage);
  messageInput.value = '';

  // Envía el mensaje al servidor
  fetch('/enviar_mensaje', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ message: messageText })
  });
});

// Carga los mensajes del servidor al iniciar la página
fetch('/ver_mensajes')
  .then(response => response.json())
  .then(messages => {
    messages.forEach(message => {
      const newMessage = document.createElement('p');
      newMessage.textContent = message;
      messagesDiv.appendChild(newMessage);
    });
  });
</script>
<!--
  /*
        function sendMessage(message) {
  // Crear un objeto con los datos del mensaje
  var data = {message: message};

  // Convertir el objeto en formato JSON
  var jsonData = JSON.stringify(data);

  // Enviar el mensaje a través de Ajax
  $.ajax({
    type: 'POST',
    url: '/api/send-message',
    data: jsonData,
    contentType: 'application/json',
    success: function(response) {
      console.log(response);
      // Actualizar los mensajes en la vista
      updateMessages(response);
    },
    error: function(error) {
      console.log(error);
    }
  });
}
function receiveMessages() {
  // Obtener los mensajes a través de Ajax
  $.ajax({
    type: 'GET',
    url: '/api/receive-messages',
    contentType: 'application/json',
    success: function(response) {
      console.log(response);
      // Actualizar los mensajes en la vista
      updateMessages(response);
    },
    error: function(error) {
      console.log(error);
    }
  });
}
function updateMessages(messages) {
  var messagesDiv = $('.messages');
  messagesDiv.empty();
  for (var i = 0; i < messages.length; i++) {
    var message = messages[i];
    var messageText = message.message;
    var messageDiv = $('<div>').text(messageText);
    messagesDiv.append(messageDiv);
  }
}
setInterval(function() {
  receiveMessages();
}, 1000);

$('.message-form').on('submit', function(e) {
  e.preventDefault();
  var message = $('input[type=text]').val();
  sendMessage(message);
  $('input[type=text]').val('');
});
*/
-->
  </body>
</html>