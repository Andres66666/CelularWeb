<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/mensaje.css">
</head>
<body>
    <div class="container">
        <div class="header">
          <h2>Abel</h2>
          <a href="../index.html"><button class="exit-button"> Salir</button></a>
          
        </div>
        <div class="messages">
          <!-- aquí se mostrarían los mensajes -->
        </div>
        <form class="message-form">
          <input id="message-input" type="text" placeholder="Escribe tu mensaje aquí...">
          <button class="send-button"><img src="../img/mensaje.png" alt="" width="20" height="20"></button>
          <button class="delete-button">⌫</button>
        </form>
      </div>

<script type="text/javascript">
const CACHE_NAME = 'mensaje-cache';

// Escucha el evento 'install' para crear la caché
self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then((cache) => {
        return cache.addAll([
          '/index.html',
          '/script.js',
          '/styles.css',
        ]);
      })
  );
});

// Escucha el evento 'fetch' para recuperar los mensajes de la caché
self.addEventListener('fetch', (event) => {
  event.respondWith(
    caches.match(event.request)
      .then((response) => {
        if (response) {
          return response;
        }

        return fetch(event.request)
          .then((response) => {
            if (!response || response.status !== 200 || response.type !== 'basic') {
              return response;
            }

            const responseToCache = response.clone();

            caches.open(CACHE_NAME)
              .then((cache) => {
                cache.put(event.request, responseToCache);
              });

            return response;
          });
      })
  );
});

// Escucha el evento 'message' para guardar los mensajes en la caché
self.addEventListener('message', (event) => {
  if (event.data.message) {
    caches.open(CACHE_NAME)
      .then((cache) => {
        cache.add(event.data.message);
      });
  }
});

</script>
  </body>
</html>